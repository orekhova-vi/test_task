# –ó–∞–¥–∞–Ω–∏–µ ‚Ññ4

–ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å –ª–æ–≥–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤–∞–∫–∞–Ω—Å–∏–π:
</br>
ts ‚Äì –≤—Ä–µ–º—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</br>
user ‚Äì ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</br>
ip ‚Äì IP-–∞–¥—Ä–µ—Å</br>
user_agent ‚Äì –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</br>
vacancy_id ‚Äì ID –≤–∞–∫–∞–Ω—Å–∏–∏

# üïµÔ∏è –ê–Ω–∞–ª–∏–∑ –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤–∞–∫–∞–Ω—Å–∏–π

## üìä 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

+ 5-10 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤–∞–∫–∞–Ω—Å–∏–π –∑–∞ —Å–µ—Å—Å–∏—é
+ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ (Chrome, Firefox)
+ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ (5-30 —Å–µ–∫)

### üö® –ü—Ä–∏–∑–Ω–∞–∫–∏ –∞–Ω–æ–º–∞–ª–∏–π

- –±–æ–ª—å—à–µ 100 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤ –º–∏–Ω—É—Ç—É –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–¥–∏–Ω IP ‚Üí –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- User-Agent: Python/curl/–ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –±–æ–ª—å—à–µ 10K –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –æ–¥–Ω–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏ –∑–∞ —á–∞—Å
  
## üîç 2. SQL-–∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

üë• –¢–û–ü-10 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```sql
SELECT 
    user,
    COUNT(*) AS views,
    MIN(ts) AS first_view,
    MAX(ts) AS last_view,
    COUNT(*) / EXTRACT(EPOCH FROM (MAX(ts)-MIN(ts))) AS req_per_sec
FROM logs
WHERE ts > NOW() - INTERVAL '1 hour'
GROUP BY user
HAVING COUNT(*) > 50
ORDER BY views DESC
LIMIT 10;
```
–ú–µ—Ç—Ä–∏–∫–∏ –∞–Ω–∞–ª–∏–∑–∞:

- –±–æ–ª–µ–µ 1000 views/hour - —è–≤–Ω–∞—è –∞–Ω–æ–º–∞–ª–∏—è
- req_per_sec > 0.5 - –±–æ—Ç-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ù–æ—á–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –¥–Ω–µ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

üåê –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞
```sql
SELECT
    ip,
    COUNT(DISTINCT user) AS unique_users,
    COUNT(*) AS total_views,
    COUNT(DISTINCT user_agent) AS agents_count
FROM logs
WHERE ts > NOW() - INTERVAL '30 minutes'
GROUP BY ip
HAVING 
    COUNT(*) > 100 OR
    COUNT(DISTINCT user) > 5
ORDER BY total_views DESC;
```

–ú–µ—Ç—Ä–∏–∫–∏ –∞–Ω–∞–ª–∏–∑–∞:

- unique_users > 10 - –≤–æ–∑–º–æ–∂–Ω–∞ VPN/–ø—Ä–æ–∫—Å–∏
- agents_count = 1 –ø—Ä–∏ unique_users > 3 - –±–æ—Ç-—Å–µ—Ç—å

ü§ñ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–æ—Ç–æ–≤
```sql
SELECT
    CASE
        WHEN user_agent LIKE '%Python%' THEN 'Python-bot'
        WHEN user_agent = '' THEN 'Null user agent'
        ELSE 'Normal'
    END AS agent_type,
    COUNT(*) AS requests,
    COUNT(DISTINCT ip) AS unique_ips
FROM logs
GROUP BY agent_type
ORDER BY requests DESC;
```

## üõ°Ô∏è 3. –°–∏—Å—Ç–µ–º–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤

| –¢–∏–ø –∞–Ω–æ–º–∞–ª–∏–∏               | –ü–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è      | –î–µ–π—Å—Ç–≤–∏–µ                          |
|----------------------------|-------------------------|-----------------------------------|
| –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è    | >50 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É   | üì¢ –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç              |
| –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å IP-–∞–¥—Ä–µ—Å–∞       | >100 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 5 –º–∏–Ω—É—Ç| üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç              |
| –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π User-Agent  | –°–æ–¥–µ—Ä–∂–∏—Ç "Python"       | üü° –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç               |


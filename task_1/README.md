# üìù –ó–∞–¥–∞–Ω–∏–µ ‚Ññ1

–£ –Ω–∞—Å –µ—Å—Ç—å 3 —Ç–∞–±–ª–∏—Ü—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —É –∫–ª–∏–µ–Ω—Ç–∞: `Violation_a`, `Violation_b`, `Violation_c`.

## üóÇ –û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

### –¢–∞–±–ª–∏—Ü–∞ ‚Ññ1: Violation_a
```sql
Violation_a (
    dt TIMESTAMP,          -- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –Ω–∞—Ä—É—à–µ–Ω–∏—è
    employer BIGINT,       -- –∫–ª–∏–µ–Ω—Ç (ID)
    user BIGINT,           -- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (ID)
    attempts_count INT,    -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
    PRIMARY KEY (dt, employer, user) -- –°–æ—Å—Ç–∞–≤–Ω–æ–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
)
```

### –¢–∞–±–ª–∏—Ü–∞ ‚Ññ2: Violation_b
```sql
Violation_b (
    date VARCHAR(10),      -- –î–∞—Ç–∞ –Ω–∞—Ä—É—à–µ–Ω–∏—è (—Ñ–æ—Ä–º–∞—Ç —Å—Ç—Ä–æ–∫–∏ 'YYYY-MM-DD')
    employer BIGINT,       -- –∫–ª–∏–µ–Ω—Ç (ID)
    user BIGINT,           -- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (ID)
    views_count INT,       -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
    PRIMARY KEY (date, employer, user) -- –°–æ—Å—Ç–∞–≤–Ω–æ–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
)
```

### –¢–∞–±–ª–∏—Ü–∞ ‚Ññ3: Violation_c
```sql
Violation_c (
    dt TIMESTAMP,          -- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –Ω–∞—Ä—É—à–µ–Ω–∏—è
    employer VARCHAR(50),  -- –∫–ª–∏–µ–Ω—Ç (ID)
    user BIGINT,           -- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (ID)
    has_access BOOLEAN,    -- –ù–∞–ª–∏—á–∏–µ –¥–æ—Å—Ç—É–ø–∞ (TRUE/FALSE)
    PRIMARY KEY (dt, employer, user) -- –°–æ—Å—Ç–∞–≤–Ω–æ–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
)
```

## üìä–°–æ–∑–¥–∞–¥–∏–º —Ç–∞–±–ª–∏—Ü—ã –∏ –≤–Ω–µ—Å–µ–º –¥–∞–Ω–Ω—ã–µ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —É—Å–ª–æ–≤–∏–π. 

***Violation_a:***<br/>
<img src="https://github.com/user-attachments/assets/8b5ce841-ca9d-438a-9ec6-080955036062" alt="image" width="500" height="400">

***Violation_b:***<br/>
<img src="https://github.com/user-attachments/assets/85a8fc5a-3759-4295-81c8-efef5e7703c9" alt="image" width="500" height="400">

***Violation_c:***<br/>
<img src="https://github.com/user-attachments/assets/b7d57e71-9cdb-4f2f-a77d-233edd57d8fe" alt="image" width="500" height="400">

##

<h3> –®–∞–≥–∏ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏: </h3>
1. –î–ª—è —Ç–∞–±–ª–∏—Ü—ã Violation_a –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏, –ø–æ—ç—Ç–æ–º—É –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–ª—è–º –∫–ª–∏–µ–Ω—Ç (employer) –∏ –¥–∞—Ç–µ (dt) –∏ –ø–æ—Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π –∏ —Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫. <br/>
<br/>
2. –î–ª—è —Ç–∞–±–ª–∏—Ü—ã Violation_b –Ω–∞—Ä—É—à–∏–≤—à–∏–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è, –≤—Å–µ —Ç–µ –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å—É–º–º–∞—Ä–Ω–æ –∑–∞ –¥–µ–Ω—å –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –±–æ–ª–µ–µ 500 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ (views_count>500), –ø–æ—ç—Ç–æ–º—É –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–ª—è–º –∫–ª–∏–µ–Ω—Ç (employer) –∏ –¥–∞—Ç–µ (date), –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä HAVING –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ä–∞–Ω–µ–µ —É—Å–ª–æ–≤–∏–π. <br/>
<br/>
3. –î–ª—è —Ç–∞–±–ª–∏—Ü—ã Violation_—Å –Ω–∞—Ä—É—à–∏–≤—à–∏–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è, –≤—Å–µ —Ç–µ –∫–ª–∏–µ–Ω—Ç—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö —Ö–æ—Ç—è –±—ã –¥–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–º–µ–ª–∏ –¥–æ—Å—Ç—É–ø, –ø–æ—ç—Ç–æ–º—É –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–ª—è–º –∫–ª–∏–µ–Ω—Ç (employer) –∏ –¥–∞—Ç–µ (dt), –∏ —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø, –¥–∞–ª–µ–µ —Ñ–∏–ª—å—Ç—Ä—É–µ–º —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ —É—Å–ª–æ–≤–∏—é.<br/>
<br/>
4. –ê–∫–∫—É–º—É–ª–∏—Ä—É–µ–º –≤—Å–µ –Ω–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–ø–∏—Å–∞–ª–∏ –≤—ã—à–µ –≤ –µ–¥–∏–Ω—ã–π –∑–∞–ø—Ä–æ—Å. –¢—É—Ç –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é WITH, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü, –æ–±—ä–µ–¥–µ–Ω–∏–º –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—è FULL JOIN, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ —É—á–µ—Å—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏.<br/>
<br/>
*–ø—Ä–∏–≤–æ–¥–∏–º —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∫ –æ–±—â–µ–º—É —Ñ–æ—Ä–º–∞—Ç—É, –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã Violations_b –ø–æ–ª–µ date –ø—Ä–∏–≤–æ–¥–∏–º –∫ —Ç–∏–ø—É data, –∞ –≤ —Ç–∞–±–ª–∏—Ü–µ Violation_—Å –ø–æ–ª–µ employer –∫ —Ç–∏–ø—É BIGINT.<br/> 

##

***üìå–ò–¢–û–ì:*** —Ñ–æ—Ä–º–∏—Ä—É–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—Ä–µ—Ö —Ç–∏–ø–∞—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.
<img src="https://github.com/user-attachments/assets/3008edb3-3683-4a4d-aa03-9c9e26c45d8b" alt="image" width="1000" height="300">




